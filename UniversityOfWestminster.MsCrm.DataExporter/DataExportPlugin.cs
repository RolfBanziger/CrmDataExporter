using System;
using System.ComponentModel.Composition;
using XrmToolBox.Extensibility;
using XrmToolBox.Extensibility.Interfaces;

namespace UniversityOfWestminster.MsCrm.DataExporter
{
    [Export(typeof(IXrmToolBoxPlugin)),
    ExportMetadata("Name", "Data Exporter"),
    ExportMetadata("Description", "Export any data using FetchXML queries"),
    ExportMetadata("SmallImageBase64", "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"),
    ExportMetadata("BigImageBase64", "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"),
    ExportMetadata("BackgroundColor", "#FFFFFF"),
    ExportMetadata("PrimaryFontColor", "#560634"),
    ExportMetadata("SecondaryFontColor", "DarkGray")]
    public class DataExportPlugin : PluginBase
    {
        /// <summary>
        /// Returns the UI Control representing the Data Export Plugin.
        /// </summary>
        /// <returns></returns>
        public override IXrmToolBoxPluginControl GetControl()
        {
            return new MainUserControl();
        }
    }
}
